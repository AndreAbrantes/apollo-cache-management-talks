import { Head, Steps, Invert } from 'mdx-deck';

import SocialMediaHandle from './components/SocialMediaHandle';
import Layout from "./components/Layout";
import end from './assets/images/end.png';
import clientSideCashing from './assets/images/client-side-cashing.png';
import apolloClientImage from './assets/images/apollo-client.png';
import apolloClientIcon from "./assets/icons/apollo-client.png";
import goBack from './assets/gifs/go-back.gif';
import difficult from './assets/gifs/difficult.gif';
import rainbow from './assets/gifs/rainbow.gif';
import myTheme from './theme';

export const theme = myTheme;

<Head>
  <title>Cache Management on AC3</title>
  <link rel="icon" href={apolloClientIcon} />
</Head>

<Layout>
  <img
    src={apolloClientImage} 
    style={{
      height: 100,
      marginBottom: '2em'
    }}
  />

  ## Cache Management on AC3

  Laura Beatris, Full Stack Developer
</Layout>

---

<Layout isInvert>

<Invert>

### Let's go back for a minute 

<img src={goBack} style={{ maxHeight: 400 }} />

We need to understand how cache works on the web

</Invert>

</Layout>

---

<Layout>

# What is cache and why it's necessary?

<Steps>

- Cache data is stored on your computer or phone when you browse the internet
- Decreases the response time 
- Avoid unnecessary requests to the server
- Reduces bandwidth = Benefits the user 

</Steps>

</Layout>

---

<Layout>

# Client Side Cashing

<img src={clientSideCashing} style={{ height: 400 }} />

- Exists since 90's
- Via HTTP headers (Last-Modified, Cache-Control, etc)
- Control over the browser requests from the server 

<a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html">
  https://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html
</a>

</Layout>

---

<Layout>

## Client Cache, Local Storage, Session Storage...

</Layout>

---

<Layout>

## Client Cache, Local Storage, Session Storage...

### It all ends up on the same goal

</Layout>

---

<Layout>

# Persisting data on the web!

</Layout>

---

<Layout isInvert>

<Invert>

# But dealing with cache on GraphQL isn't that easy  

<img src={difficult} style={{ height: 400 }} />

</Invert>

</Layout>

---

<Layout>

### Reasons: 

<Steps>

- GraphQL API's hits a single endpoint 
- Hard to predic the response because of the flexibity of fields 
- GraphQL clients send bodies to the server with POST method instead of GET

</Steps>

</Layout>

---

<Layout>

# But Apollo Client provides an abstraction layer to manage cache

<img 
  src="https://wp.apollographql.com/wp-content/uploads/2020/07/the_cache_1.png" 
  style={{
    height: 400,
    borderRadius: 10
  }}
/>

<br />

<small>
  Source: 
  {" "}
  <a href="https://www.apollographql.com/blog/demystifying-cache-normalization/">
  https://www.apollographql.com/blog/demystifying-cache-normalization/
  </a>
</small>

</Layout>

---

<Layout>

### Now we just need to learn the cache API :)

<img src={rainbow} style={{ height: 350 }} />

</Layout>

---

<Layout isInvert>

<Invert>

# What happens if you don't understand the AC cache api:

<Steps>

- Having unnecessary network requests
- Using the wrong fetch policy and leading to a bad UX 
- Caching the wrong entities 

</Steps>

</Invert>

</Layout>

---

<Layout showFooter={false}>

## That's the end!

- Slides: https://apollo-cache-management-talk.vercel.app/

<h3>
  <SocialMediaHandle />
</h3>

</Layout>